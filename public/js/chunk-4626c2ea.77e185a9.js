(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4626c2ea"],{6574:function(t,e){e.f=Object.getOwnPropertySymbols},9539:function(t,e,a){"use strict";var s=a("0b4c"),i=a("6574"),n=a("d0e9"),o=a("bb33"),r=a("93a7"),l=Object.assign;t.exports=!l||a("7372")(function(){var t={},e={},a=Symbol(),s="abcdefghijklmnopqrst";return t[a]=7,s.split("").forEach(function(t){e[t]=t}),7!=l({},t)[a]||Object.keys(l({},e)).join("")!=s})?function(t,e){var a=o(t),l=arguments.length,c=1,p=i.f,m=n.f;while(l>c){var u,f=r(arguments[c++]),g=p?s(f).concat(p(f)):s(f),d=g.length,h=0;while(d>h)m.call(f,u=g[h++])&&(a[u]=f[u])}return a}:l},aeeb:function(t,e,a){},d0e9:function(t,e){e.f={}.propertyIsEnumerable},d75a:function(t,e,a){var s=a("9736");s(s.S+s.F,"Object",{assign:a("9539")})},ea50:function(t,e,a){"use strict";var s=a("aeeb"),i=a.n(s);i.a},eace:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container",staticStyle:{margin:"15px 15px"}},[a("el-row",{staticStyle:{"font-size":"16px",color:"#303133"},attrs:{type:"flex",justify:"start"}},[t._v(t._s(t.pageTitle))]),a("el-row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex",justify:"start"}},[a("el-form",{ref:"form",staticStyle:{"min-width":"500px"},attrs:{model:t.form,rules:t.rules,"label-width":"80px","label-position":"right"}},[a("el-form-item",{attrs:{label:"页面名称",prop:"name"}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{placeholder:"请输入页面名称",type:"textarea",autosize:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),a("div",{staticStyle:{"margin-left":"10px","font-size":"14px","font-weight":"900"}},[t._v("页面内容"),a("i",{staticClass:"avatar-limit"},[t._v("图片小于1M,格式jpg,png,jpeg")])]),t._l(t.form.page_items,function(e,s){return["content"==e.item_type?a("el-form-item",{key:s,attrs:{label:"文字"}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:20}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入文字 ",type:"textarea",autosize:""},model:{value:e.content,callback:function(a){t.$set(e,"content",a)},expression:"item.content"}})],1),a("el-col",{attrs:{span:2,offset:2}},[a("el-button",{attrs:{icon:"el-icon-delete",size:"mini"},on:{click:function(e){t.deleteTextImage(s)}}})],1)],1)],1):t._e(),"image"==e.item_type?a("el-form-item",{key:s,attrs:{label:"图片"}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:10}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,drag:!1,multiple:!1,"on-success":t.handleAvatarSuccess(e),"before-upload":t.beforeAvatarUpload}},[e.image?a("img",{staticClass:"avatar",attrs:{src:e.image}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-col",{attrs:{span:2,offset:2}},[a("el-button",{attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(e){t.deleteTextImage(s)}}})],1)],1)],1):t._e()]}),a("el-row",{staticStyle:{"margin-bottom":"30px","margin-top":"30px"}},[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addText}},[t._v("添加文字")]),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addImage}},[t._v("添加图片")])],1),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("保存")])],2)],1)],1)},i=[],n=(a("d75a"),a("58e0"),{components:{},data:function(){return{pageState:"",pageTitle:"",pageId:"",form:{name:"",page_items:[]},rules:{name:{required:!0,message:"请输入资讯标题名称",trigger:"blur"}}}},watch:{pageState:function(t){var e="自定义";switch(t){case 1:this.pageTitle="新增".concat(e);break;case 2:this.pageTitle="编辑".concat(e);break;case 3:this.pageTitle="".concat(e,"详情");break}}},methods:{queryPageDetail:function(){var t=this,e={page_id:this.pageId};this.$http.pageDetail(e,"get").then(function(e){var a=e.data.success;t.form=a,console.log("InfomationDetail",a)})},addText:function(){this.form.page_items.push({item_type:"content",image:"",content:""})},addImage:function(){this.form.page_items.push({item_type:"image",image:"",content:""})},deleteTextImage:function(t){this.form.page_items.splice(t,1)},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var a={};a.name=e.form.name,a.page_items_attributes=e.form.page_items.map(function(t,e){return Object.assign({position:e},t)}),console.log(a),1===e.pageState?e.$http.addPage(a,"post").then(function(t){var a=t.data.success;a?e.$message.success("新增成功"):e.$message.error("新增失败")}):e.$http.editPage(a,"post").then(function(t){var a=t.data.success;a?e.$message.success("修改成功"):e.$message.error("修改失败")})})},handleAvatarSuccess:function(t){return function(e){t.image=e.url||""}},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type&&"image/jpg"===t.type&&"image/png"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传图片只能是 jpg、jpeg、png 格式!"),a||this.$message.error("上传图片大小不能超过 2MB!"),e&&a}},mounted:function(){this.pageState=+this.$route.query.pageState||1,this.pageId=this.$route.query["page_id"]||"",1!==this.pageState&&this.queryPageDetail()}}),o=n,r=(a("ea50"),a("048f")),l=Object(r["a"])(o,s,i,!1,null,null,null);l.options.__file="detail.vue";e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-4626c2ea.77e185a9.js.map