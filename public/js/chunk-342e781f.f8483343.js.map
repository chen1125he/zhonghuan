{"version":3,"sources":["webpack:///./node_modules/_core-js@2.6.2@core-js/modules/es6.string.starts-with.js","webpack:///./node_modules/_core-js@2.6.2@core-js/modules/_string-context.js","webpack:///./node_modules/_@babel_runtime-corejs2@7.2.0@@babel/runtime-corejs2/core-js/get-iterator.js","webpack:///./node_modules/_core-js@2.6.2@core-js/library/fn/get-iterator.js","webpack:///./node_modules/_core-js@2.6.2@core-js/library/modules/core.get-iterator.js","webpack:///./node_modules/_core-js@2.6.2@core-js/modules/_fails-is-regexp.js","webpack:///./src/views/page/detail.vue?a87c","webpack:///./src/views/page/detail.vue?d1df","webpack:///src/views/page/detail.vue","webpack:///./src/views/page/detail.vue?e1fc","webpack:///./src/views/page/detail.vue?e697","webpack:///./node_modules/_@babel_runtime-corejs2@7.2.0@@babel/runtime-corejs2/core-js/object/assign.js"],"names":["$export","__webpack_require__","toLength","context","STARTS_WITH","$startsWith","P","F","startsWith","searchString","that","this","index","Math","min","arguments","length","undefined","search","String","call","slice","isRegExp","defined","module","exports","NAME","TypeError","anObject","get","getIterator","it","iterFn","MATCH","KEY","re","e","f","_node_modules_mini_css_extract_plugin_0_5_0_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_1_0_1_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_15_5_1_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_3_0_0_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_1_2_5_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_15_5_1_vue_loader_lib_index_js_vue_loader_options_detail_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_0_5_0_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_1_0_1_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_15_5_1_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_3_0_0_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_1_2_5_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_15_5_1_vue_loader_lib_index_js_vue_loader_options_detail_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","margin","font-size","color","attrs","type","justify","to","replace","_v","_s","pageTitle","margin-top","ref","width","model","form","rules","label-width","label-suffix","label-position","label","prop","placeholder","value","callback","$$v","$set","expression","_l","item","_destroy","_e","key","item_type","image","src","url","on","click","$event","removeImage","action","show-file-list","on-success","handleAvatarSuccess","name","before-upload","beforeAvatarUpload","icon","size","deletePage","margin-bottom","plain","addText","addImage","onSubmit","submitBtnTitle","staticRenderFns","detailvue_type_script_lang_js_","components","data","pageState","pageId","id","page_items","required","message","trigger","methods","validateItems","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","get_iterator_default","next","done","content","$message","error","err","return","formatSubmitValue","ret","page","assign_default","page_items_attributes","map","image_attributes","splice","push","position","submit","_this","console","log","stringify_default","$http","submitFuncName","then","res","result_rows","success","_this2","$refs","validate","valid","catch","deleteTextImage","_this3","file","isImg","isLt2M","created","_this4","$router","currentRoute","pageDetail","params","page_detailvue_type_script_lang_js_","component","Object","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"js/chunk-342e781f.f8483343.js","sourcesContent":["// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = require('./_is-regexp');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) throw TypeError('String#' + NAME + \" doesn't accept regex!\");\n  return String(defined(that));\n};\n","module.exports = require(\"core-js/library/fn/get-iterator\");","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n","var MATCH = require('./_wks')('match');\nmodule.exports = function (KEY) {\n  var re = /./;\n  try {\n    '/./'[KEY](re);\n  } catch (e) {\n    try {\n      re[MATCH] = false;\n      return !'/./'[KEY](re);\n    } catch (f) { /* empty */ }\n  } return true;\n};\n","import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.5.0@mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/_css-loader@1.0.1@css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.5.0@mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/_css-loader@1.0.1@css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\",staticStyle:{\"margin\":\"15px 15px\"}},[_c('el-row',{staticStyle:{\"font-size\":\"16px\",\"color\":\"#303133\"},attrs:{\"type\":\"flex\",\"justify\":\"start\"}},[_c('router-link',{staticClass:\"el-button--text\",attrs:{\"to\":\"/page/list\",\"replace\":\"\"}},[_vm._v(\"页面管理\")]),_vm._v(\"\\n    / \"+_vm._s(_vm.pageTitle)+\"\\n  \")],1),_c('el-row',{staticStyle:{\"margin-top\":\"30px\"},attrs:{\"type\":\"flex\",\"justify\":\"start\"}},[_c('el-form',{ref:\"form\",staticStyle:{\"width\":\"100%\"},attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"100px\",\"label-suffix\":\":\",\"label-position\":\"left\"}},[_c('el-form-item',{attrs:{\"label\":\"页面名称\",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入页面名称\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('h1',{staticStyle:{\"font-size\":\"20px\"}},[_vm._v(\"页面内容\")]),_vm._l((_vm.form.page_items),function(item,index){return [(!item._destroy)?_c('el-form-item',{key:index,attrs:{\"label\":item.item_type == 'content' ? '文字' : '图片'}},[_c('el-row',[(item.item_type == 'content')?_c('el-input',{staticClass:\"content\",attrs:{\"placeholder\":\"请输入文字\",\"type\":\"textarea\"},model:{value:(item.content),callback:function ($$v) {_vm.$set(item, \"content\", $$v)},expression:\"item.content\"}}):[(item.image.url)?_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":item.image.url}}),_c('i',{staticClass:\"el-icon-circle-close\",on:{\"click\":function($event){_vm.removeImage(index)}}})]):_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"http://szebra.cn/api/admin/images\",\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess(index),\"name\":\"image[file]\",\"before-upload\":_vm.beforeAvatarUpload}},[_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],_c('el-button',{key:'btn' + index,staticClass:\"delete-btn\",attrs:{\"icon\":\"el-icon-delete\",\"size\":\"small\",\"type\":\"danger\"},on:{\"click\":function($event){_vm.deletePage(index)}}})],2),(item.item_type != 'content')?_c('el-row',{staticStyle:{\"margin-top\":\"20px\"}},[_vm._v(\"\\n            公众号文章地址: \"),_c('el-input',{model:{value:(item.link),callback:function ($$v) {_vm.$set(item, \"link\", $$v)},expression:\"item.link\"}})],1):_vm._e()],1):_vm._e()]}),_c('el-row',{staticStyle:{\"margin-bottom\":\"30px\",\"margin-top\":\"30px\"}},[_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\",\"size\":\"small\"},on:{\"click\":_vm.addText}},[_vm._v(\"添加文字\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\",\"size\":\"small\"},on:{\"click\":_vm.addImage}},[_vm._v(\"添加图片\")])],1),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(_vm._s(_vm.submitBtnTitle))])],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container\" style=\"margin: 15px 15px;\">\r\n    <!-- 页面名字 -->\r\n    <el-row type=\"flex\" justify=\"start\" style=\" font-size: 16px; color: #303133;\">\r\n      <router-link class='el-button--text' to=\"/page/list\" replace>页面管理</router-link>\r\n      / {{pageTitle}}\r\n    </el-row>\r\n    <el-row type=\"flex\" justify=\"start\" style=\"margin-top: 30px;\">\r\n     <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"100px\" label-suffix=\":\" label-position=\"left\" style=\"width: 100%\">\r\n        <el-form-item label=\"页面名称\" prop=\"name\">\r\n          <el-input v-model=\"form.name\" placeholder=\"请输入页面名称\" />\r\n        </el-form-item>\r\n        <h1 style=\"font-size: 20px\">页面内容</h1>\r\n        <template v-for=\"(item, index) in form.page_items\">\r\n          <el-form-item v-if=\"!item._destroy\" :label=\"item.item_type == 'content' ? '文字' : '图片'\" :key=\"index\">\r\n            <el-row>\r\n              <el-input class=\"content\" v-if=\"item.item_type == 'content'\" v-model=\"item.content\" placeholder=\"请输入文字\" type=\"textarea\" />\r\n              <template v-else>\r\n                <div v-if=\"item.image.url\" class=\"avatar\">\r\n                  <img :src=\"item.image.url\" />\r\n                  <i class=\"el-icon-circle-close\" @click=\"removeImage(index)\" />\r\n                </div>\r\n                <el-upload v-else class=\"avatar-uploader\"\r\n                          action=\"http://szebra.cn/api/admin/images\"\r\n                          :show-file-list=\"false\"\r\n                          :on-success=\"handleAvatarSuccess(index)\"\r\n                          name=\"image[file]\"\r\n                          :before-upload=\"beforeAvatarUpload\">\r\n                  <i class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                </el-upload>\r\n              </template>\r\n              <el-button class=\"delete-btn\" icon=\"el-icon-delete\" size=\"small\" @click=\"deletePage(index)\" :key=\"'btn' + index\" type=\"danger\" />\r\n            </el-row>\r\n            <el-row v-if=\"item.item_type != 'content'\" style=\"margin-top: 20px\">\r\n              公众号文章地址: <el-input v-model=\"item.link\" />\r\n            </el-row>\r\n          </el-form-item>\r\n        </template>\r\n        <el-row style=\"margin-bottom: 30px;margin-top: 30px;\">\r\n          <el-button type=\"primary\" plain size=\"small\" @click=\"addText\">添加文字</el-button>\r\n          <el-button type=\"primary\" plain size=\"small\" @click=\"addImage\">添加图片</el-button>\r\n        </el-row>\r\n        <el-button type=\"primary\" @click=\"onSubmit\">{{submitBtnTitle}}</el-button>\r\n      </el-form>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n<script>\r\nconst G_IMAGE_SIZE = 2 // 图片大小\r\n\r\nexport default {\r\n  components: {\r\n  },\r\n  data () {\r\n    return {\r\n      pageState: '', // 1新增，2编辑，3预览\r\n      pageTitle: '', // 页面标题\r\n      pageId: '', // 自定义页面id\r\n      submitBtnTitle: '',\r\n      form: {\r\n        id: '',\r\n        name: '',\r\n        page_items: []\r\n      },\r\n      rules: { // 校验规则\r\n        name: { required: true, message: '请输入资讯标题名称', trigger: 'blur' }\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    validateItems () {\r\n      for (let item of this.form.page_items) {\r\n        if (item._destroy) continue\r\n        switch (item.item_type) {\r\n          case 'content':\r\n            if (!item.content) {\r\n              this.$message.error('文本内容不可为空')\r\n              return\r\n            }\r\n            break\r\n          case 'image':\r\n            if (!item.image || !item.image.url || !item.image.id) {\r\n              this.$message.error('图片不可为空')\r\n              return\r\n            }\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    formatSubmitValue () {\r\n      if (!this.validateItems()) return\r\n\r\n      const ret = { id: this.form.id, page: Object.assign({}, this.form) }\r\n      ret.page.page_items = ret.page.id = undefined\r\n      ret.page.page_items_attributes = this.form.page_items.map(item => {\r\n        item = Object.assign({}, item)\r\n        if (item.item_type === 'image') {\r\n          item.image_attributes = Object.assign(item.image)\r\n          item.image = undefined\r\n        }\r\n        return item\r\n      })\r\n      return ret\r\n    },\r\n    deletePage (index) {\r\n      this.form.page_items[index]._destroy = true\r\n      this.form.page_items.splice(index, this.form.page_items[index].id ? 0 : 1)\r\n    },\r\n    addText () {\r\n      this.form.page_items.push({\r\n        item_type: 'content',\r\n        content: '',\r\n        position: this.form.page_items.length\r\n      })\r\n    },\r\n    addImage () {\r\n      this.form.page_items.push({\r\n        item_type: 'image',\r\n        image: { id: '', url: '' },\r\n        position: this.form.page_items.length\r\n      })\r\n    },\r\n    submit () {\r\n      const data = this.formatSubmitValue()\r\n      console.log(JSON.stringify(data))\r\n      if (!data) return\r\n      this.$http[this.submitFuncName](data).then(res => {\r\n        if (!res) return\r\n        Object.assign(this.form, res.data.result_rows)\r\n        this.$message.success('保存成功')\r\n      })\r\n    },\r\n    onSubmit () {\r\n      this.$refs.form.validate()\r\n      .then(valid => this.submit())\r\n      .catch(() => {})\r\n    },\r\n    deleteTextImage () {},\r\n    removeImage (index) {\r\n      this.form.page_items[index].image.url = ''\r\n    },\r\n    handleAvatarSuccess (index) {\r\n      return data => this.form.page_items[index].image = data.result_rows\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isImg = file.type.startsWith('image/');\r\n      const isLt2M = file.size / 1024 / 1024 < 5;\r\n      if (!isImg) {\r\n        this.$message.error('只允许上传图片');\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传图片大小不能超过 5MB!');\r\n      }\r\n      return isImg && isLt2M;\r\n    }\r\n  },\r\n  created () {\r\n    switch (this.$router.currentRoute.name) {\r\n        case 'page_create':\r\n          this.pageTitle = '添加页面'\r\n          this.submitBtnTitle = '提交'\r\n          this.submitFuncName = 'pageCreate'\r\n          break\r\n        default:\r\n          this.pageTitle = '编辑页面'\r\n          this.submitBtnTitle = '保存所有编辑结果'\r\n          this.submitFuncName = 'pageUpdate'\r\n          this.$http.pageDetail(this.$router.currentRoute.params)\r\n            .then(res => {\r\n              if (!res) return\r\n              Object.assign(this.form, res.data.result_rows)\r\n            })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n  .el-input {\r\n    width: 270px;\r\n  }\r\n  .content {\r\n    width: 80%;\r\n    float: left;\r\n  }\r\n  .delete-btn {\r\n    margin-left: 10px;\r\n  }\r\n  .avatar-uploader {\r\n    max-width: 80%;\r\n    float: left;\r\n  }\r\n  .avatar-uploader .el-upload {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n    display: inline-block;\r\n  }\r\n  .avatar-uploader .el-upload:hover {\r\n    border-color: #409EFF;\r\n  }\r\n  .avatar-uploader-icon {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 178px;\r\n    height: 178px;\r\n    line-height: 178px;\r\n    text-align: center;\r\n  }\r\n  .avatar {\r\n    position: relative;\r\n    float: left;\r\n    margin-right: 5px;\r\n  }\r\n  .avatar img {\r\n    margin-top: 6px;\r\n    margin-right: 6px;\r\n    width: 178px;\r\n    height: 178px;\r\n  }\r\n  .avatar i {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    opacity: 0.6;\r\n  }\r\n  .avatar i:hover {\r\n    opacity: 1;\r\n    cursor: pointer;\r\n  }\r\n</style>\r\n","import mod from \"-!../../../node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@1.2.0@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js!../../../node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@1.2.0@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.5@babel-loader/lib/index.js!../../../node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./detail.vue?vue&type=template&id=1a107060&\"\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.5.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"detail.vue\"\nexport default component.exports","module.exports = require(\"core-js/library/fn/object/assign\");"],"sourceRoot":""}